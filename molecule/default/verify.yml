---
- name: Verify
  hosts: all
  gather_facts: false
  tasks:
    - name: Ensure /etc/hosts.molecule is valid
      ansible.builtin.copy:
        dest: /etc/hosts.molecule
        content: |
          # Ansible managed: Do NOT edit this file manually!

          10.42.42.42               molecule.example.com molecule
          127.0.0.1                 localhost
          127.0.0.42                instance.example.com instance
          ::1                       localhost ip6-localhost ip6-loopback
          fe00::0                   ip6-localnet
          ff00::0                   ip6-mcastprefix
          ff02::1                   ip6-allnodes
          ff02::2                   ip6-allrouters
          ff02::3                   ip6-allhosts
        mode: 0644
      check_mode: true
      register: result
      failed_when: result is changed
